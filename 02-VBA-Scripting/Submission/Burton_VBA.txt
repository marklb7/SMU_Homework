Option ExplicitSub stock_ticker()    ' Set an initial variable for holding the stock name    Dim Stock_Name As String    ' Set an initial variable for holding the volume per stock    Dim Stock_Volume As Double    ' Declare i    Dim i As Double        ' Determine the Last Row    Dim LastRow As Double        ' Keep track of the location for each stock ticker in the summary table    Dim Summary_Table_Row As Integer        ' Open/Close Prices    Dim Open_Price As Double    Dim Close_Price As Double    Dim Yearly_Change As Double    Dim Percent_Change As Double        ' Declare worksheet    Dim ws As Worksheet        ' Second summary table variables    Dim Max_Increase As String    Dim Max_Decrease As String    Dim Max_Volume As String    Dim Max_Inc As Double    Dim Max_Dec As Double    Dim Max_Vol As Double    ' --------------------------------------------    ' LOOP THROUGH ALL SHEETS    ' --------------------------------------------    For Each ws In Worksheets        ' Set summary table names        ws.Cells(1, 9) = "Ticker"        ws.Cells(1, 10) = "Yearly Change"        ws.Cells(1, 11) = "Percent Change"        ws.Cells(1, 12) = "Total Stock Volume"        ws.Cells(1, 15) = "Ticker"        ws.Cells(1, 16) = "Value"        ws.Cells(2, 14) = "Greatest % Increase"        ws.Cells(3, 14) = "Greatest % Decrease"        ws.Cells(4, 14) = "Greatest Total Volume"                ' Initialize variavles        Stock_Volume = 0        LastRow = ws.Cells(Rows.Count, 1).End(xlUp).Row        Summary_Table_Row = 2        Max_Inc = 0        Max_Dec = 0        Max_Vol = 0        Open_Price = Cells(2, 3).Value                        ' Loop through all stock purchases        For i = 2 To LastRow                    ' Add to the stock volume            Stock_Volume = Stock_Volume + ws.Cells(i, 7).Value                    ' Check if we are still within the same stock ticker, if it is not...            If ws.Cells(i + 1, 1).Value <> ws.Cells(i, 1).Value Then                            ' Take stock's closing price                Close_Price = ws.Cells(i, 6).Value                                ' Yearly change                Yearly_Change = Close_Price - Open_Price                                ' Percent change                If Open_Price = 0 Then                    Percent_Change = 0                Else:                    Percent_Change = 100 * (Yearly_Change / Open_Price)                End If                ' Set the stock name                Stock_Name = ws.Cells(i, 1).Value                                ' Print the stock name in the Summary Table                ws.Range("I" & Summary_Table_Row).Value = Stock_Name                                ' Print the yearly change to the Summary Table                ws.Range("J" & Summary_Table_Row).Value = Yearly_Change                                ' Conditional formatting                If Yearly_Change > 0 Then                    ws.Range("J" & Summary_Table_Row).Interior.ColorIndex = 4                ElseIf Yearly_Change < 0 Then                    ws.Range("J" & Summary_Table_Row).Interior.ColorIndex = 3                Else                    ws.Range("J" & Summary_Table_Row).Interior.ColorIndex = 2                End If                                ' Print the percent change to the Summary Table                ws.Range("K" & Summary_Table_Row).Value = Percent_Change                                ' Print the stock volume to the Summary Table                ws.Range("L" & Summary_Table_Row).Value = Stock_Volume                                ' Add one to the summary table row                Summary_Table_Row = Summary_Table_Row + 1                                ' Reset the stock volume                Stock_Volume = 0                Open_Price = ws.Cells(i + 1, 3)                        End If                    Next i                'Loop through summary table to make 2nd table        For i = 2 To Summary_Table_Row            If ws.Cells(i, 11).Value > Max_Inc Then                Max_Inc = ws.Cells(i, 11).Value                Max_Increase = ws.Cells(i, 9)            End If                        If ws.Cells(i, 11).Value < Max_Dec Then                Max_Dec = ws.Cells(i, 11).Value                Max_Decrease = ws.Cells(i, 9)            End If                        If ws.Cells(i, 12).Value > Max_Vol Then                Max_Vol = ws.Cells(i, 12).Value                Max_Volume = ws.Cells(i, 9)            End If        Next i                          'Print to 2nd summary table        ws.Range("O2").Value = Max_Increase        ws.Range("O3").Value = Max_Decrease        ws.Range("O4").Value = Max_Volume        ws.Range("P2").Value = Max_Inc        ws.Range("P3").Value = Max_Dec        ws.Range("P4").Value = Max_Vol        Next ws                End Sub        